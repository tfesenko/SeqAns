<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="./lib/FileSaver.js"></script>
  <script src="./lib/ntseq.js"></script>
  <script src="./load-inputs.js"></script>
  <script src="./sequence-annotations.js"></script>
  <style>

  .annotation-rect {
    fill-opacity: 0.0;
    stroke-width: 3;
    stroke: #000;
  }

  .navbar {
    list-style-type: none;
    margin: 0;
    padding: 0;
    overflow: hidden;
    background-color: #C1C1C1;
  }

  .navbar span {
    float: left;
  }

  li a, .dropbtn {
    display: inline-block;
    color: white;
    text-align: center;
    padding: 14px 16px;
    text-decoration: none;
  }

  li a:hover, .dropdown:hover .dropbtn {
    background-color: red;
  }

  li.dropdown {
    display: inline-block;
  }

  .dropdown-content {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 160px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
  }

  .dropdown-content a {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .dropdown-content a:hover {background-color: #f1f1f1}

  .dropdown:hover .dropdown-content {
    display: block;
  }

  </style>

  <script type="text/javascript">


    function downloadSVG(fileName){
        
        try {
            var isFileSaverSupported = !!new Blob();
        } catch (e) {
            alert("blob not supported");
        }

        var currY = 0;
        var gap = 30;

        var html = d3.selectAll("svg")[0].map(function(g, i) {
          //  debugger;
            var svgStr = "<!--LINE " + (i+1) + "-->\n<svg y='" + (currY + gap) + "'>" + g.innerHTML + "</svg>";
            currY += parseInt(g.getAttribute("height"));
            return svgStr;
        }).join("\n");

        html = '<svg xmlns="http://www.w3.org/2000/svg" height="' + currY + '">\n'
            + html +
            '\n</svg>';
        var blob = new Blob([html], {type: "image/svg+xml"});
        saveAs(blob, fileName);
    };
    </script>
  </head>

  <body>

    <div class="navbar">
      <span>Sequence Annotations</span>
      <span class="dropdown">
        <a href="javascript:void(0)" class="dropbtn">File</a>
        <div class="dropdown-content">
          <a href="#">Load Sequences from a FASTA file:</a>
          <input type="file" id="files" name="files[]"/>
          <a href="#" onclick="downloadSVG('sequence.svg')">Save as SVG</a>
        </div>
      </span>
    </div>

    <script type="text/javascript">

      document.getElementById('files').addEventListener('change', handleFileSelect, false);


      var margin = 75,
      width = 1400 - margin,
      height = 5600 - margin;

    var svg = d3.select("body")
      .append("div");
//      .attr("width", width + margin)
//      .attr("height", height + margin);

      var seq1 =
        'ATGGACAAGAAGTATAGCATCGGGCTGGACATTGGAACGAACTCGGTTGGTTGGGCTGTGATTACGGACG' +
        'AATACAAGGTGCCATCCAAGAAGTTTAAGGTCCTGGGAAACACCGACCGTCACTCAATCAAGAAGAATCT' +
        'CATTGGAGCCCTGCTCTTCGATAGTGGGGAGACCGCCGAAGCTACTCGACTGAAGCGAACGGCTCGCCGG' +
        'CGTTATACACGACGCAAGAATCGCATCTGCTACCTCCAGGAGATTTTCAGCAACGAAATGGCTAAGGTTG' +
        'ATGACTCATTCTTTCATCGACTCGAAGAAAGTTTCTTGGTCGAGGAGGATAAGAAGCACGAGCGCCATCC' +
        'GATCTTTGGTAACATTGTGGATGAGGTTGCCTATCACGAAAAGTACCCAACTATCTATCATCTTCGTAAG' +
        'AAGCTGGTCGATAGCACGGACAAGGCTGATTTGCGACTTATCTACCTGGCACTCGCGCACATGATTAAGT' +
        'TCCGCGGCCATTTTCTTATCGAGGGTGACCTGAACCCCGATAATTCTGACGTTGATAAGCTCTTCATCCA' +
        'GTTGGTCCAAACCTACAATCAGCTGTTTGAGGAAAACCCTATTAATGCATCTGGCGTGGACGCCAAGGCT' +
        'ATCCTTTCGGCGCGCCTGTCTAAGTCGCGGCGTTTGGAGAACCTTATCGCACAACTCCCCGGCGAAAAGA' +
        'AGAACGGCCTCTTCGGTAATTTGATTGCGTTGTCACTTGGTCTGACTCCTAACTTCAAGAGTAATTTTGA' +
        'CCTGGCAGAGGATGCGAAGCTCCAGTTGTCTAAGGATACGTATGATGACGATCTCGACAACTTGCTTGCC' +
        'CAAATCGGTGACCAGTACGCTGATCTTTTCCTGGCCGCTAAGAATCTCTCAGATGCAATCCTGCTCAGTG' +
        'ACATTTTGCGGGTCAACACCGAGATTACTAAGGCCCCCCTGTCAGCTAGTATGATCAAGCGGTATGATGA' +
        'GCACCATCAGGACCTCACCTTGCTTAAGGCCCTCGTGCGTCAGCAATTGCCTGAGAAGTACAAGGAAATC' +
        'TTCTTTGACCAATCCAAGAACGGATACGCAGGGTATATTGATGGCGGTGCGAGCCAGGAGGAATTCTACA' +
        'AGTTTATCAAGCCGATTTTGGAGAAGATGGACGGCACTGAGGAACTGCTCGTCAAGCTGAATCGCGAAGA' +
        'TTTGCTTCGTAAGCAACGAACGTTCGACAACGGCTCCATCCCGCACCAGATTCATCTGGGCGAGCTCCAC';
    var seq2 =
        'TAGGACAAGAAGTATAGCATCGGGCTGGACATTGGAACGAACTCGGTTGGTTGGGCTGTGATTACGGACG' +
        'AATACAAGGTGCCATCCAAGAAGTTTAAGGTCCTGGGAAACACCGACCGTCACTCAATCAAGAAGAATCT' +
        'CATTGGAGCCCTGCTCTTCGATAGTGGGGAGACCGCCGAAGCTACTCGACTGAAGCGAACGGCTCGCCGG' +
        'CGTTATACACGACGCAAGAATCGCATCTGCTACCTCCAGGAGATTTTCAGCAACGAAATGGCTAAGGTTG' +
        'ATGACTCATTCTTTCATCGACTCGAAGAAAGTTTCTTGGTCGAGGAGGATAAGAAGCACGAGCGCCATCC' +
        'GATCTTTGGTAACATTGTGGATGAGGTTGCCTATCACGAAAAGTACCCAACTATCTATCATCTTCGTAAG' +
        'AAGCTGGTCGATAGCACGGACAAGGCTGATTTGCGACTTATCTACCTGGCACTCGCGCACATGATTAAGT' +
        'TCCGCGGCCATTTTCTTATCGAGGGTGACCTGAACCCCGATAATTCTGACGTTGATAAGCTCTTCATCCA' +
        'GTTGGTCCAAACCTACAATCAGCTGTTTGAGGAAAACCCTATTAATGCATCTGGCGTGGACGCCAAGGCT' +
        'ATCCTTTCGGCGCGCCTGTCTAAGTCGCGGCGTTTGGAGAACCTTATCGCACAACTCCCCGGCGAAAAGA' +
        'AGAACGGCCTCTTCGGTAATTTGATTGCGTTGTCACTTGGTCTGACTCCTAACTTCAAGAGTAATTTTGA' +
        'CCTGGCAGAGGATGCGAAGCTCCAGTTGTCTAAGGATACGTATGATGACGATCTCGACAACTTGCTTGCC' +
        'CAAATCGGTGACCAGTACGCTGATCTTTTCCTGGCCGCTAAGAATCTCTCAGATGCAATCCTGCTCAGTG' +
        'ACATTTTGCGGGTCAACACCGAGATTACTAAGGCCCCCCTGTCAGCTAGTATGATCAAGCGGTATGATGA' +
        'GCACCATCAGGACCTCACCTTGCTTAAGGCCCTCGTGCGTCAGCAATTGCCTGAGAAGTACAAGGAAATC' +
        'TTCTTTGACCAATCCAAGAACGGATACGCAGGGTATATTGATGGCGGTGCGAGCCAGGAGGAATTCTACA' +
        'AGTTTATCAAGCCGATTTTGGAGAAGATGGACGGCACTGAGGAACTGCTCGTCAAGCTGAATCGCGAAGA' +
        'TTTGCTTCGTAAGCAACGAACGTTCGACAACGGCTCCATCCCGCACCAGATTCATCTGGGCGAGCTCCAC';
    var seq3 =
        'GTAGACAAGAAGTATAGCATCGGGCTGGACATTGGAACGAACTCGGTTGGTTGGGCTGTGATTACGGACG' +
        'AATACAAGGTGCCATCCAAGAAGTTTAAGGTCCTGGGAAACACCGACCGTCACTCAATCAAGAAGAATCT' +
        'CATTGGAGCCCTGCTCTTCGATAGTGGGGAGACCGCCGAAGCTACTCGACTGAAGCGAACGGCTCGCCGG' +
        'CGTTATACACGACGCAAGAATCGCATCTGCTACCTCCAGGAGATTTTCAGCAACGAAATGGCTAAGGTTG' +
        'ATGACTCATTCTTTCATCGACTCGAAGAAAGTTTCTTGGTCGAGGAGGATAAGAAGCACGAGCGCCATCC' +
        'GATCTTTGGTAACATTGTGGATGAGGTTGCCTATCACGAAAAGTACCCAACTATCTATCATCTTCGTAAG' +
        'AAGCTGGTCGATAGCACGGACAAGGCTGATTTGCGACTTATCTACCTGGCACTCGCGCACATGATTAAGT' +
        'TCCGCGGCCATTTTCTTATCGAGGGTGACCTGAACCCCGATAATTCTGACGTTGATAAGCTCTTCATCCA' +
        'GTTGGTCCAAACCTACAATCAGCTGTTTGAGGAAAACCCTATTAATGCATCTGGCGTGGACGCCAAGGCT' +
        'ATCCTTTCGGCGCGCCTGTCTAAGTCGCGGCGTTTGGAGAACCTTATCGCACAACTCCCCGGCGAAAAGA' +
        'AGAACGGCCTCTTCGGTAATTTGATTGCGTTGTCACTTGGTCTGACTCCTAACTTCAAGAGTAATTTTGA' +
        'CCTGGCAGAGGATGCGAAGCTCCAGTTGTCTAAGGATACGTATGATGACGATCTCGACAACTTGCTTGCC' +
        'CAAATCGGTGACCAGTACGCTGATCTTTTCCTGGCCGCTAAGAATCTCTCAGATGCAATCCTGCTCAGTG' +
        'ACATTTTGCGGGTCAACACCGAGATTACTAAGGCCCCCCTGTCAGCTAGTATGATCAAGCGGTATGATGA' +
        'GCACCATCAGGACCTCACCTTGCTTAAGGCCCTCGTGCGTCAGCAATTGCCTGAGAAGTACAAGGAAATC' +
        'TTCTTTGACCAATCCAAGAACGGATACGCAGGGTATATTGATGGCGGTGCGAGCCAGGAGGAATTCTACA' +
        'AGTTTATCAAGCCGATTTTGGAGAAGATGGACGGCACTGAGGAACTGCTCGTCAAGCTGAATCGCGAAGA' +
        'TTTGCTTCGTAAGCAACGAACGTTCGACAACGGCTCCATCCCGCACCAGATTCATCTGGGCGAGCTCCAC';

      //draw([{sequence:seq1, title:"Human"}, {sequence:seq2, title:"Mouse"}, {sequence:seq3, title:"Yeast"}]);
    </script>
  </body>
  </html>